name: Main Workflow

on:
  workflow_dispatch:
    inputs:
      example_input:
        description: 'An example input for the main workflow'
        required: false
        default: 'default main value'

jobs:
  trigger-target-workflow:
    runs-on: [ self-hosted, Linux ]
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Trigger Target Workflow
        id: trigger_workflow
        run: |
          RUN_ID=$(gh workflow run target-workflow.yml --ref main --json id -q '.id')
          echo "RUN_ID=$RUN_ID" >> $GITHUB_ENV

      - name: Wait for Target Workflow Completion
        run: |
          gh run watch ${{ env.RUN_ID }}
